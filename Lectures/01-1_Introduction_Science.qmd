---
title: "Reproducible Data Analysis for Biomedical Research"
author:
  - name: Elizabeth King and Kevin Middleton
    affiliations: Division of Biological Sciences
html-math-method:
  method: mathjax
  url: "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
format:
  clean-revealjs:
    self-contained: true
    chalkboard: false
    standalone: true
    slide-number: true
    show-slide-number: print
code-annotations: hover
bibliography: QMLS_Bibliography.bib
csl: evolution.csl
---

```{r}
#| label: setup
#| echo: false

library(tidyverse)
library(ggtext)
ggplot2::theme_set(cowplot::theme_cowplot())
```


# Welcome {background-color="#40666e"}


## Where are you?


### Reproducible Data Analysis for Biomedical Research

- Tuesdays and Thursdays 12:30 - 1:45
- Tucker Hall 322


## Who are we?
:::: {.columns}

::: {.column width="50%"}
**Dr. Elizabeth King** (she/her)

- Grew up in Southeastern Wisconsin (until 7th grade) $\rightarrow$ Chicagoland
- Iowa (4 years) $\rightarrow$ California (10 years) $\rightarrow$ Missouri (12 years)
- MU 12 years in Biology
:::

::: {.column width="50%"}
**Dr. Kevin Middleton** (he/him)

- Grew up in Florida
- North Carolina $\rightarrow$ Rhode Island (10 years) $\rightarrow$ California (1 year) $\rightarrow$ Rhode Island (1 year) $\rightarrow$ California (5 years) $\rightarrow$ Missouri
- MU 14 years (10 in Medicine, 4 in Biology)

:::

::::

<hr />

- Biologists by training
- Engineers, theoreticians, statisticians, and programmers by avocation
- We are married.


## {background-image="images/Lab_research.jpg" background-size="100%" fig-alt="Middleton lab research interest collage."}


## {background-image="images/King_Lab.jpg" background-size="100%" fig-alt="King lab research interest collage."}


## Are we qualified to teach this class?

- Probably
- Taught undergraduates, post-bacs, and graduate students for 15+ years
- Complementary perspectives and skill sets

:::{.callout-note}


## Why are we teaching this class?

- These skills are increasingly important for you as scientists
- A basic understanding of statistics will make you a more informed consumer
- Learning for the sake of learning
- You might find that you really enjoy it
:::


## Who are you?

- Preferred name & Pronouns
- Major(s)
- Future plans
- Favorite place in Columbia and why?


# Questions {background-color="#f8c471"}


# Goals {background-color="#40666e"}


## What do we want to accomplish? (Narrow view)

- Begin to learn about the research process
- Begin data analysis / statistics
- Begin data presentation / graphing
- Begin presenting / writing about science
- Begin to use computers to make your scientific life easier


## What do we want to accomplish? (Wide view)

> I'm convinced that coding ... changes the cognitive way one looks at a quantifiable phenomenon. It changes the modality the brain thinks of how to interpret a problem and how to model it (when possible). It forces you to think logically/algorithmically and it allows you to learn better new arguments when this learning is necessary.

> While the comprehension of specific statistical tests is specifically linked to particular problems, general coding skills allow us to imagine (and to realize) simulated experiments, toy examples, etc. I think the benefit is cognitive besides the advantages for scientific rigor/reproducibility and of course for the scientific community.

::: {.right}
Paolo Piras (2024)
:::


## Have you ever read a scientific paper?


## What do we want to accomplish? (Wide view)

:::{.alert}
Expand the ways in which you think about and interact with science
:::

- Become a better citizen of science
    - We are all consumers
    - You don't have to be a producer (but it's great if you are)


## Learning Objectives

1.	Describe the processes involved in reproducible research.
2.	Discuss research study design, including considerations of biological sex, race, and ethnicity.
3.	Design studies with appropriate power to answer research questions.
4.	Manage data and maintain data integrity.
5.	Carry out statistical analyses using data relevant to their research questions and interpret those analyses.
6.	Create publication-quality figures for reports, posters, and presentations
7.	Write about and present statistical analyses.


## Desired Student Outcomes

1.	Appreciate that research is a set of skills that can be learned and learn that everyone has a place in research.
2.	Accept that uncertainty is an inherent property of the world and variation is pervasive in nature. We try to make decisions with statistics in the face of that uncertainty and variation.
3.	Recognize that all aspects of science – from planning to presentation – are collaborative and recognize the benefits of diverse points of view in the scientific process.


## Premise

*Axiom 1*: Quantitative potential is distributed equally among different groups, irrespective of geographic, demographic, and economic boundaries.

*Axiom 2*. Everyone can have joyful, meaningful, and empowering quantitative experiences.

*Axiom 3*. Quantitative methods are powerful, malleable tools that can be shaped and used differently by various communities to serve their needs.

*Axiom 4*. Every student deserves to be treated with dignity and respect.

::: aside
Modified from Frederico Ardila-Mantilla's "Todos Cuentan: Cultivating Diversity in Combinatorics" (2017; *Notices of the AMS* 63: 1164-1170)
:::


# Expectations {background-color="#40666e"}


## Expectations for you

-	Be an active participant in class.
-	Be present with your classmates.
-	Ask questions.
-	Be prepared for class/discussion.
-	Be willing to fail and keep trying.
    - This process is part of learning.
    - Confusion is your mind adjusting to new information.
-	Accept that making mistakes is part of the process of learning.
- Be proactive about communicating your needs


## Expectations for us

- Listen to you
- Be responsive to your questions
- Adapt
- Be prompt and prepared


## Asking questions

- Class
- Canvas: Required weekly questions
- Emails: (kingeg@missouri.edu and middletonk@missouri.edu)
- Offices:
    - King: Tucker Hall Room 401
    - Middleton: Tucker Hall Room 224
- [Anonymously](https://forms.office.com/r/k27q3HWQwa) via web

![](images/Anonymous_Question.png){fig-align="center" fig-alt="Image showing the location in Canvas to post an anonymous question."}


## Course communications from us

- Canvas announcements and messages
    - Sign up for email notifications
- Emails (very rarely)


## Three-week check-in

- How are you doing?
- What is working or not working for you?
- How is the pace?
- What challenges do you have?
- What can we do better?

Maybe again later in the semester


# Let's look at Canvas {background-color="#40666e"}

- General information
- Planned schedule


## Working together

- Your coding partner
- Help each other problem solve
- Rotates every two weeks
- Self- and Peer-evaluations


## General Weekly Plan

**Tuesday**

- "Lecture", demos, discussion
- Previous week's problem set due
- Sit with your partner

**Thursday**

- Finish up Tuesday material
- Review / questions
- Start problem set


# Wellbeing and Communications {background-color="#40666e"}


## Missing class, late assignments, etc.

- Let us know if you are going to miss class or as soon as you can (if feasible) after missing class.
    - If you miss more than 3 classes, we will ask you to schedule a meeting with us to discuss a plan.
- If you need more time on an assignment, you must get in touch with us *before it is due* for approval.


# Questions {background-color="#f8c471"}


# "Artificial Intelligence" {background-color="#40666e"}


## Artificial intelligence is not intelligence

- We (unfortunately) use human terms to describe LLMs: "intelligence", "learn", "understand", "think", "know", "hallucinate"
- LLMs generate responses based on probabilities (what character/word comes next?), which are derived from their training data.
- [Large Language Models explained briefly (YouTube)](https://www.youtube.com/watch?v=LPZh9BOjkQs){target="_blank"}


:::{.callout-note}
## Predicting based on probability
Predict $y$ if $x = 3$.

$$y = 2x + 3$$
:::


## What are the next two numbers in the sequence?

$$1, 3, 5, 7$$
or

$$1, 3, 5, 7, 17, 19, 21$$

LLMs can answer the first but not the second.


## Ways in which large language models can fail you

- *Outdated and/or incorrect information*: LLMs are trained on historical data, which might have changed or be incorrect
- *Inability to explain*: If you don't code it yourself, you will have greater challenges explaining it
- *Debugging challenges*: If your code doesn't work, then figuring out why will be more challenging
- *Short circuit* the development of problem-solving skills in our learn-by-doing approach
    - Be willing to fail and keep trying.
- *Limiting you creativity and innovation*: There are many ways to solve a coding challenge (think about different recipes for the same dish)


## Please don't use AI to write code for you

- Problem sets are graded for completeness and effort *not* correctness.
- Progress checks will use ideas/code that you have seen before.

"Give me an example of how to change the axis labels in ggplot."


## Course AI guidelines: "AI Integration Allowed: Human-in-the-Loop"

- Generative AI is discouraged, but may be used in this course (see last slide).
- Any content you submit is your responsibility.
- Be sure your work accurately reflects your understanding and avoids these pitfalls.
- You are responsible for *understanding* what you submit. Simply copying an AI-generated solution does not contribute to gaining understanding.
- **Do not use AI for writing answers to free-response questions.**
    - You are learning to "write" about science.


## Course AI guidelines: "AI Integration Allowed: Human-in-the-Loop"

If you use AI, you must acknowledge it with some variation of this statement:

> "I acknowledge the use of AI in completing [*which part of*] this assignment and would like to provide a brief explanation of how I utilized AI, specifically [*LLM*], as a tool to support my work. For this assignment, I employed [*LLM*] to [*describe the specific purpose or task*]. To do so I crafted the following prompts: [*List prompts used*]"


# Questions {background-color="#f8c471"}


# Why do we use statistics?  {background-color="#40666e"}


## Breeding Mice for High Activity

![](https://biology.ucr.edu/people/faculty/Garland/MusonWheel-EQ.jpg){fig-align="center"}


## Breeding Mice for High Activity

{{< video https://www.youtube.com/watch?v=RuqhC7g_XP0 >}}


## Effects of selection

```{r}
#| fig-alt: "Line plot showing the number of revolutions per day across 10 generations in 4 lines of control mice and 4 lines of selected mice."

C <- readr::read_csv(
    "../data/Mice/Mouse_Control.csv",
    show_col_types = FALSE
) |>
    mutate(
        Generation = rep(0:10, times = 4),
        Line = rep(1:4, each = 11),
        LineType = "Control Lines"
    ) |>
    rename(Revolutions = y)
HR <- readr::read_csv("../data/Mice/Mouse_HR.csv", show_col_types = FALSE) |>
    mutate(
        Generation = rep(0:10, times = 4),
        Line = rep(5:8, each = 11),
        LineType = "Selected Lines"
    ) |>
    rename(Revolutions = y)

DD <- bind_rows(C, HR)

ggplot(
    DD,
    aes(x = Generation, y = Revolutions, group = Line, color = LineType)
) +
    geom_line(linewidth = 1) +
    geom_point(size = 3) +
    scale_color_manual(values = c("navy", "firebrick"), name = NULL) +
    scale_x_continuous(breaks = 0:10) +
    scale_y_continuous(limits = c(0, 12000), labels = scales::comma) +
    theme(
        legend.position = "inside",
        legend.position.inside = c(0.1, 0.9),
        axis.title = element_text(face = "bold")
    ) +
    labs(y = "Revolutions / Day")
```


## What patterns do you see?

```{r}
#| fig-alt: "Scatter plot of muscle mass plotted against body mass for 3 groups of mice."

MM <- readr::read_rds("../data/Mice/MouseMuscle.rds") |>
    mutate(Line = factor(Line)) |>
    drop_na() |>
    filter(Sex == "Female")

ggplot(MM, aes(x = Body_Mass, y = Muscle_Mass, color = Line)) +
    geom_point(size = 3) +
    scale_color_manual(values = c("navy", "firebrick", "lightblue")) +
    labs(x = "**Body Mass (g)**", y = "**Muscle Mass (g)**") +
    theme(
        strip.background = NULL,
        strip.text = element_text(color = "black", face = "bold", size = 12),
        axis.title.x = element_markdown(),
        axis.title.y = element_markdown()
    )
```


## Assumptions of science as a way of knowing

- All ways of knowing involve a set of assumptions
- Our knowledge is conditional on these assumptions being met

:::{.alert}
What assumptions do we make about these mice?
:::


## Definitions of statistics

"a collection of procedures and principles for gaining **information** in order to make decisions when faced with **uncertainty**" [@Utts2005-mg]

"a way of taming **uncertainty**, of turning raw **data** into arguments that can resolve profound questions" [@Amabile1989-pf]

"the science of drawing conclusions from **data** with the aid of the mathematics of **probability**" [@Garfunkel1986-vv]

"the **explanation** of **variation** in the context of what remains **unexplained**" [@Kaplan2009-zu]


## Key concepts in statistics

**Data**: The raw material for doing statistics are data, which come in a variety of forms.

**Information**: The goal of statistics is to gain information, make a decision, or explain.

**Uncertainty**: The context for statistics is that there is always some level of uncertainty

**Probability**: The tool that we will use to assess our uncertainty and gain information is probability.


## Statistics in the context of life sciences

- Describe, measure, and compare aspects of nature from **samples**
- Quantify the **uncertainty** of those measures
- **Estimation** of an unknown quantity from a **sample** of a **population**
    - *Differences* between groups
    - *Relationships* between variables or traits


## Samples and populations

A **population** includes all the members/individuals/units of a group of interest.

- A parameter is a quantity that describes a population without error (e.g., means, standard deviations, proportions).
- Requires measuring *every* member of that group.


## Samples and populations

A **sample** is a representative subset of a population, ideally randomly chosen. A sample can be an individual subject or a group of subjects.

- An estimate is the inferred value of a parameter based on a sample from a population.

*You will (usually) deal with samples.*


## Deviations resulting from sampling

**Sampling error** is the deviation from the population parameter resulting from chance alone.

- **Precision** is the amount of spread among the observations around the true population parameter resulting from sampling error.

**Bias/Inaccuracy** is the *systematic departure* of an estimate from the population parameter being estimated.


## Goals of data collection: Low sampling error and low bias {#myImagePage}

![](https://i.imgur.com/eP5dSny.png){fig-align="center" fig-alt="Figure showing four dart boards with clusters of points in all combinations of Accurate-Inaccurate and Precise-Imprecise."}


## Thinking about sampling error and bias

Consider the scale in a physician's office. The same patient is weighed 3 times in succession:

1. 72.0 kg
2. 73.8 kg
3. 70.1 kg

True mass is 72.1 kg. Sampling error or bias?


## Thinking about sampling error and bias

Consider the same physician's thermometer. The same patient's temperature 3 times in succession:

1. 98.2°
2. 98.3°
3. 98.2°

True temperature is 99.3°. Sampling error or bias?

*What is the real challenge here?*


## Testing for bias

- Standard curves
- Calibration
- Simulation


## Randomness

A repeatable process is random if its outcome is

- Unpredictable in the short run
- Predictable in the long run

e.g., coin flipping (fair coin)

- We don't know what the result of a single flip will be
- We do know what the long run probability of heads will be


## Random sampling

Assumptions of most statistical analyses

1. **Equal chance**: Each member of a population has an equal chance of being included in the sample
2. **Independence**: No member that is chosen influences the others that are chosen *or* their outcomes (e.g., trait values)

*Goals*:

- Minimize bias
- Allow an estimation of sampling error (important)


## Independent and identically distributed (IID)

- All observations are independent of one another
- All observations come from the same underlying probability distribution (distributions in Unit 2)

:::{.alert}
Standard assumptions of most statistical tests.
:::


## Sampling design for a forest

Randomly select 20 trees (left) or randomly select 20 square areas with 0 or more trees (right).

![](https://i.imgur.com/KcKmZYi.png){fig-align="center" width=80% fig-alt="Pair of figures of an experimental forest. On the left, individual trees are selected. On the right random plots are selected."}

:::: {.columns}

::: {.column width="50%"}
- What are the benefits and drawbacks of each?
- Are individual trees independent?
:::

::: {.column width="50%"}
- Are areas independent?
- Are trees *within* areas independent?
:::

::::


## Asking a question

- Canvas: slides, recording
- Discussion board: post a question (due Wednesday midnight)


## References

::: {#refs}
:::

---
title: "PC 1 Review"
html-math-method:
  method: mathjax
  url: "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
format:
  clean-revealjs:
    self-contained: true
    chalkboard: false
    standalone: true
    slide-number: true
    show-slide-number: print
code-annotations: hover
bibliography: QMLS_Bibliography.bib
csl: evolution.csl
---

```{r}
#| label: setup
#| echo: false

library(tidyverse)
```


# Housekeeping {background-color="#40666e"}

- Micropublication
- Review / questions


# Micropublications {background-color="#40666e"}


## Micropublications [https://www.micropublication.org/](https://www.micropublication.org/)

> "brief, novel findings, negative and/or reproduced results, and results which may lack a broader scientific narrative."

- New finding - novel discoveries, new reagents and/or methods
- Null/negative result
- Replication - successful (including being "scooped")
- Replication - unsuccessful
- Materials and Reagents
- Methodology
- Data updates

:::{.alert}
Not every publication needs to be expansive.
:::


## Project

Produce a *reproducible* micropublication-style report (3-5 pages)

- Scientific question / Background
- Use your own data or data from the literature
    - We will help you
- Methods and analysis
    - Describing analyses and writing about results
- A figure (can be multi-panel, can have images, must be reproducible)
- A table (if needed)
- References


## Skills

- Determining appropriate analyses to answer questions
- Writing about statistics
- Making publication-ready figures (colors, font size, etc.)
- Making tables
- Writing figure captions and table headers
- Extracting information from R during rendering
- Including references
- HTML or PDF (We will provide templates)
- Presenting


## Key dates

- 3/31: Data/Topic due
- 4/14: Plan due
    - Question
    - Dataset
    - Figure plan
    - Analysis ideas
- 5/12: Presentations (2 slides)
- 5/16: Project due


# Questions {background-color="#f8c471"}


## R "Vocabulary"

> I was wondering if we could go over some of the more important functions in R and use examples and go line by line just explaining what everything is doing. The help page is useful but the explanations can be very over-engineered and sometimes the human answer is the better one.


## R "Vocabulary"

(Almost) all the functions used in Units 1-4:

```{r}
source("../extract_functions.R")

qmds_lecture <- list.files(
  pattern = "^[0-4]*-[1-6].*qmd$",
  path = "../Lectures",
  full.names = TRUE
)[1:7]

qmds_problems_sets <- list.files(
  pattern = "^PS_[0-9]*[_Key]*.qmd$",
  path = "../Problem_Sets",
  full.names = TRUE
)[1:6]

extract_functions(c(qmds_lecture, qmds_problems_sets))

```


## What does set seed do?

```{r}
#| echo: true

xx <- 1:10

set.seed(462)
sample(xx)

sample(xx)

set.seed(462)
sample(xx)

```


## Object types in R

- tibble vs data.frame
- vector
- list
- functions


## `data.frame()`: a basic unit of storage

Mixed data types per column

  - Numeric
  - Character
  - Factor (categorical)
  - Logical (`TRUE` and `FALSE`)


## Making data.frame()s

```{r}
#| echo: true

MM <- data.frame(
  x = 1:3,
  y = c(10, 17, 21),
  A = c("a", "b", "c")
)
MM
```


## Extracting from data.frame()s

Either `$` or `[, ]` notation (with quoted column names).

```{r}
#| echo: true

MM$x
MM$A
MM[, "y"]
```


## Extracting from data.frame()s

```{r}
#| echo: true

MM[2, ]
MM[, 2]
```


## Tibbles

Tibbles and `data.frame`s are essentially identical, but a `tibble` is more modern and works better with tidyverse functions.

- You can convert a `data.frame` into a `tibble` with `as_tibble()`
- Tibbles never change the type of an input, never change the name of a variable, and never create row names.
- Tibbles only print 10 rows, and columns display their type (e.g., "chr", "int")


## Creating Tibbles

```{r}
#| echo: true

MM <- tibble(
  x = 1:3,
  y = x^2, # <1>
  A = c("a", "b", "c")
)
MM
```

1. Creation of a column can refer back to previously created columns

## Functions

We will get to writing our own functions later, for now: `functionName()`, where parameters go inside `()`.

```{r}
#| echo: true

c(1)
sqrt(256)
```


## Functions

```{r}
#| echo: true

log(2.718)
exp(1)
```

Get help from the R command line with ?: `?sqrt` or `?log10`. Also try `help.search("mean")`, etc.

## The pipe `|>`

- R allows you to chain operations together with a pipe: `|>`
- Passes the object from the previous operation to the next

```{r}
#| echo: true

sqrt(c(1, 5, 13))
c(1, 5, 13) |>
  sqrt()
```

- Read left-to-right, top-to-bottom


## Combine functions to explore data! {.smaller}

- You can combine multiple operations with the "pipe", or `|>`.
- This makes your code clean and more human-readable if you translate `|>` to "then".

```{r}
#| echo: true
#| message: false

bats <- read_csv("../data/bats.csv")

bats |>
    group_by(sex, age, condition) |>
    summarize(avg_mass = mean(mass)) |>
    arrange(desc(avg_mass))
```

> Read the code above as take the bats tibble, then group by sex, age, and condition and get the average mean for each combination. Finally, arrange the data in descending order by mass.




# Let's practice together

- Setting the seed
- Making a tibble
- Piping
- Using functions
- Building some plots
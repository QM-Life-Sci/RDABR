---
title: "PC 1 Review"
html-math-method:
  method: mathjax
  url: "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
format:
  clean-revealjs:
    self-contained: true
    chalkboard: false
    standalone: true
    slide-number: true
    show-slide-number: print
code-annotations: hover
bibliography: QMLS_Bibliography.bib
csl: evolution.csl
---

```{r}
#| label: setup
#| echo: false

library(tidyverse)
```


# Housekeeping {background-color="#40666e"}

- Micropublication
- Review / questions


# Micropublications {background-color="#40666e"}


## Micropublications [https://www.micropublication.org/](https://www.micropublication.org/)

> "brief, novel findings, negative and/or reproduced results, and results which may lack a broader scientific narrative."

- New finding - novel discoveries, new reagents and/or methods
- Null/negative result
- Replication - successful (including being "scooped")
- Replication - unsuccessful
- Materials and Reagents
- Methodology
- Data updates

:::{.alert}
Not every publication needs to be expansive.
:::


## Project

Produce a *reproducible* micropublication-style report (3-5 pages)

- Scientific question / Background
- Use your own data or data from the literature
    - I will help you
- Methods and analysis
    - Describing analyses and writing about results
- A figure (can be multi-panel, can have images, must be reproducible)
- A table (if needed)
- References


## Skills

- Determining appropriate analyses to answer questions
- Writing about statistics
- Making publication-ready figures (colors, font size, etc.)
- Making tables
- Writing figure captions and table headers
- Extracting information from R during rendering
- Including references
- HTML or PDF (We will provide templates)
- Presenting


## Key dates

- 3/31: Data/Topic due
- 4/14: Plan due
    - Question
    - Dataset
    - Figure plan
    - Analysis ideas
- 5/12: Presentations (2 slides)
- 5/16: Project due


# Questions {background-color="#f8c471"}

Pipe
Functions
Set Seed
Plots


## R "Vocabulary"

> I was wondering if we could go over some of the more important functions in R and use examples and go line by line just explaining what everything is doing. The help page is useful but the explanations can be very over-engineered and sometimes the human answer is the better one.


## R "Vocabulary"

(Almost) all the functions used in Units 1-4:

```{r}
source("../extract_functions.R")

qmds_lecture <- list.files(
  pattern = "^[0-4]*-[1-6].*qmd$",
  path = "../Lectures",
  full.names = TRUE
)[1:7]

qmds_problems_sets <- list.files(
  pattern = "^PS_[0-9]*[_Key]*.qmd$",
  path = "../Problem_Sets",
  full.names = TRUE
)[1:6]

extract_functions(c(qmds_lecture, qmds_problems_sets))

```


## What does set seed do?

```{r}
xx <- 1:10

set.seed(462)
sample(xx)

sample(xx)

set.seed(462)
sample(xx)

```


## Object types in R

- Tibble vs data.frame
- Array
- Vector
- List


## `data.frame()`: a basic unit of storage

Mixed data types per column

  - Numeric
  - Character
  - Factor (categorical)
  - Logical (`TRUE` and `FALSE`)


## Making data.frame()s

```{r}
#| echo: true

MM <- data.frame(
  x = 1:3,
  y = c(10, 17, 21),
  A = c("a", "b", "c")
)
MM
```


## Extracting from data.frame()s

Either `$` or `[, ]` notation (with quoted column names).

```{r}
#| echo: true

MM$x
MM$A
MM[, "y"]
```


## Extracting from data.frame()s

```{r}
#| echo: true

MM[2, ]
MM[, 2]
```


## Tibbles

Tibbles and `data.frame`s are essentially identical, but a `tibble` is more modern and works better with tidyverse functions.

- You can convert a `data.frame` into a `tibble` with `as_tibble()`
- Tibbles never change the type of an input, never change the name of a variable, and never create row names.
- Tibbles only print 10 rows, and columns display their type (e.g., "chr", "int")


## Creating Tibbles

```{r}
#| echo: true

MM <- tibble(
  x = 1:3,
  y = x^2, # <1>
  A = c("a", "b", "c")
)
MM
```

1. Creation of a column can refer back to previously created columns


## Matrices

Rectangular object of *one data type*

- Indexed by [Rows, Columns]
- Default is to fill by column (`byrow = TRUE` for row-wise)

```{r}
#| echo: true

M <- matrix(1:9, nrow = 3, ncol = 3)
M
M[2, 2]
```

- We won't use matrices very often


## Functions

We will get to writing our own functions later, for now: `functionName()`, where parameters go inside `()`.

```{r}
#| echo: true

c(1)
sqrt(256)
```


## Functions

```{r}
#| echo: true

log(2.718)
exp(1)
```

Get help from the R command line with ?: `?sqrt` or `?log10`. Also try `help.search("mean")`, etc.


## Everything in R is an "object" with a `class()`

```{r}
#| echo: true

x <- 2
class(x)
class(sqrt)
class(MM)
```

R interprets what to do based on an object's class



## What to put where in `ggplot()`

> Is there a rule of thumb for understanding if the code for a plot should go inside the parentheses of ggplot, be added on with +, or be added using the pipe?


## Let's make a plot

```{r}
# Histogram

lines <- tibble(vlines = seq(-3, 3, by = 1))

ggplot() +
  geom_histogram(
    data = tibble(x),
    mapping = aes(x),
    bins = 30,
    fill = "purple"
  ) +
  geom_vline(
    data = lines,
    mapping = aes(xintercept = vlines),
    color = "orange"
  )

# Density plot
ggplot() +
  geom_density(data = tibble(x), mapping = aes(x), fill = "purple") +
  geom_vline(
    data = lines,
    mapping = aes(xintercept = vlines),
    color = "orange"
  )
```


## Simulate data

```{r}
#| echo: true

set.seed(42)

W <- tibble(
  x = seq(0, 100, by = 5),
  y = 3 * x + 2 + rnorm(length(x), mean = 0, sd = 25)
)

ggplot(W, aes(x, y)) +
  geom_point()
```


## Look at an `lm()` summary

```{r}
#| echo: true

# "Fitted model"
fm <- lm(y ~ x + 1, data = W)

# summary(fm)
coef(fm)
```

The slope is `r round(coef(fm)[2], 2)` and the intercept is `r round(coef(fm)[1], 2)`.


## Coloring points

```{r}
set.seed(42)

W <- tibble(
  x = seq(0, 100, by = 5),
  y = 3 * x + 2 + rnorm(length(x), mean = 0, sd = 25),
  Group = "G1"
)
W2 <- tibble(
  x = seq(0, 100, by = 5),
  y = 5 * x + 12 + rnorm(length(x), mean = 0, sd = 25),
  Group = "G2"
)

WW <- bind_rows(W, W2)

ggplot() +
  geom_point(data = WW, aes(x, y, color = Group)) +
  scale_color_manual(values = c("purple", "pink"))

library(ggsci)
ggplot() +
  geom_point(data = WW, aes(x, y, color = Group)) +
  scale_color_bmj()

library(paletteer)
ggplot() +
  geom_point(data = WW, aes(x, y, color = Group)) +
  scale_color_paletteer_d("nbapalettes::pacers_classic")
```

https://pmassicotte.github.io/paletteer_gallery/#qualitative
